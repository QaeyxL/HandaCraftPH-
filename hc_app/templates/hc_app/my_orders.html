{% extends 'hc_app/base.html' %}
{% block content %}
<h2>My Orders</h2>

{% if orders %}
    {% for order in orders %}
        <div class="order-card">
            <h3>Order #{{ order.id }} - Seller: {{ order.seller.username }}</h3>
            <p>Status: {{ order.status }}</p>
            <p>Placed on: {{ order.created_at|date:"M d, Y H:i" }}</p>
            <p>Shipping Cost: ₱{{ order.shipping_cost }}</p>
            <p>Total: ₱{{ order.total }}</p>

            <h4>Items:</h4>
            <ul>
                {% for item in order.items.all %}
                    <li>{{ item.product.name }} x {{ item.quantity }} - ₱{{ item.subtotal }}</li>
                {% endfor %}
            </ul>

            {% with first_item=order.items.all.0 %}
            <p>Seller Address: {{ first_item.product.street }}, 
                {{ first_item.product.city }}, 
                {{ first_item.product.state }}, 
                {{ first_item.product.zip_code }}, 
                {{ first_item.product.country }}
            </p>
            {% endwith %}


            {% if order.buyer_street %}
            <p>Buyer Address: {{ order.buyer_street }}, 
               {{ order.buyer_city }}, {{ order.buyer_state }},
               {{ order.buyer_zip_code }}, {{ order.buyer_country }}</p>
            {% endif %}

            <form method="POST" action="{% url 'hc_app:delete_order' order.id %}">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger">Delete</button>
            </form>
        </div>
        <hr>
    {% endfor %}
{% else %}
    <p>You have no orders yet.</p>
{% endif %}

{% endblock %}
